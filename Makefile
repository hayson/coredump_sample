#****************************************************************************
#
# Copyright (C), hnoyi Technology Corp., Ltd.
#
# Author : hnoyi <hnoyi@foxmail.com>
#
# Create Date : 2023-3-23
#
#****************************************************************************

OUTPUT := test_core

CC	:= gcc
CXX	:= g++			   			 
CFLAGS  := -Wall -O0 -g 

#****************************************************************************
# Targets of the build
#****************************************************************************
all: ${OUTPUT}

#****************************************************************************
# Source files
#****************************************************************************
SUBDIRS=$(shell find . -maxdepth 1 -type d)

SRCS:=$(foreach dir,$(SUBDIRS),$(wildcard $(dir)/*.cpp))\
			$(foreach dir,$(SUBDIRS),$(wildcard $(dir)/*.c))

OBJS=$(patsubst %.c, %.o, $(patsubst %.cpp, %.o, $(SRCS))) 
	
#****************************************************************************
# Output
#****************************************************************************

${OUTPUT}: ${OBJS}
	${CC} -o $@ ${OBJS} 

#****************************************************************************
# common rules
#****************************************************************************

# Rules for compiling source files to object files
%.o : %.cpp
	${CXX} -c ${CXXFLAGS}  $< -o $@

%.o : %.c
	${CC} -c ${CFLAGS} $< -o $@	

clean:
	rm -f ${OUTPUT} ${OBJS}		
	
